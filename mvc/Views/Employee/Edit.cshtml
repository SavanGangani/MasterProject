@model tblEmployee

@{
    ViewData["Title"] = "UpdateEmployeeData";
}

<div class="container">
    <div class="row">
        <div class="col">
            <h2>Update Employee Data</h2>
        </div>
    </div>
    <form asp-action="Edit" method="post" enctype="multipart/form-data">
        <input type="hidden" asp-for="c_empid">

        <div class="form-group">
            <label asp-for="c_empname" class="control-label">Employee Name</label>
            <input asp-for="c_empname" class="form-control" value="@Model.c_empname" />
            <span asp-validation-for="c_empname" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="c_empgender" class="control-label">Gender</label><br>
            <div>
                <input type="radio" asp-for="c_empgender" value="Male" checked="@(Model.c_empgender == "Male")" /> Male
                <input type="radio" asp-for="c_empgender" value="Female" checked="@(Model.c_empgender == "Female")" />
                Female
                <input type="radio" asp-for="c_empgender" value="Other" checked="@(Model.c_empgender == "Other")" />
                Other
            </div>
            <span asp-validation-for="c_empgender" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="c_empdob" class="control-label">Employee DOB</label>
            <input asp-for="c_empdob" type="date" class="form-control" value="@Model.c_empdob.ToString("yyyy-MM-dd")" />
            <span asp-validation-for="c_empdob" class="text-danger"></span>
        </div>


        <div>
            <p>Shift</p>
            <input type="checkbox" name="c_empshift" value="Morning"
                checked='@Model.c_empshift.Contains("Morning")'>Morning
            <input type="checkbox" name="c_empshift" value="Afternoon"
                checked='@Model.c_empshift.Contains("Afternoon")'>Afternoon
        </div>


        <div class="form-group">
        <label>Department:</label>
        <select class="form-control" name="c_empdepartment">
            <option value="">Select Department</option>
        </select>
        <span asp-validation-for="c_empdepartment" class="text-danger"></span>
    </div>


        <div class="form-group">
            <label asp-for="c_empimg" class="control-label">Photo</label><br>
            <div class="custom-file">
                <input type="file" asp-for="c_empimg" class="custom-file-input" name="c_empimg" id="fileInput" />
                <label class="custom-file-label" for="fileInput">@Model.c_empimg</label>
            </div>
            <span asp-validation-for="c_empimg" class="text-danger"></span>
        </div>

        <div class="form-group mt-3">
            <button type="submit" class="btn btn-primary">Update Employee</button>
            <a asp-action="Index" class="btn btn-primary">Back to List</a>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {

            $.ajax({
                url: '/Employee/Department',
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    if (Array.isArray(data)) {
                        var dropdown = $('#c_empdepartment');
                        dropdown.empty().append($('<option value="">Select Department</option>'));
                        data.forEach(function (item) {
                            var option = $('<option>').val(item.c_departmentname).text(item.c_departmentname);
                            if (item.c_departmentname === '@Model.c_empdepartment') {
                                option.prop('selected', true);
                            }
                            dropdown.append(option);
                        });
                    } else {
                        console.error('Invalid data format:', data);
                    }
                },
                error: function (xhr, status, error) {
                    console.error('Error fetching designations:', status, error);
                }
            });

        });

        document.getElementById('fileInput').addEventListener('change', function () {
            var fileName = this.value.split('\\').pop();
            document.querySelector('.custom-file-label[for="fileInput"]').innerText = fileName;
        });
    </script>
}
